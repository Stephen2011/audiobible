<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Daily Bible Scriptures</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body {
  font-family: Segoe UI, sans-serif;
  font-size: 18px;
  background: #f8f9fa;
}
.dark { background:#121212; color:#eee }
.high-contrast {
  background:#000 !important;
  color:#ff0 !important;
}
.high-contrast .card { background:#000; color:#ff0 }
.card { border-radius:10px }
#reader { display:none }
</style>
</head>

<body>

<nav class="navbar navbar-dark bg-dark">
<div class="container flex-wrap gap-1">
<span class="navbar-brand">üìñ Daily Bible</span>

<button class="btn btn-outline-light btn-sm" onclick="toggleDark()">üåô</button>
<button class="btn btn-outline-warning btn-sm" onclick="toggleContrast()">üü°</button>
<button class="btn btn-outline-light btn-sm" onclick="changeFont(-1)">A‚àí</button>
<button class="btn btn-outline-light btn-sm" onclick="changeFont(1)">A+</button>

<select id="voiceSelect" class="form-select form-select-sm"></select>
</div>
</nav>

<div class="container my-4">

<div class="card p-4 text-center mb-3">
<h4>üìú Daily Scripture</h4>
<p id="scripture">Loading...</p>

<div class="d-flex justify-content-center gap-2 flex-wrap">
<button class="btn btn-success" onclick="readText('scripture')">‚ñ∂ Read</button>
<button class="btn btn-warning" onclick="pauseSpeech()">‚è∏ Pause</button>
<button class="btn btn-info" onclick="resumeSpeech()">‚ñ∂ Resume</button>
<button class="btn btn-danger" onclick="stopSpeech()">‚èπ Stop</button>
</div>
</div>

<button class="btn btn-secondary mb-3" onclick="toggleReader()">üìñ Full Bible Reader</button>

<div id="reader" class="card p-3 mb-4">
<input id="rBook" class="form-control mb-2" placeholder="Book (John)">
<input id="rChapter" class="form-control mb-2" placeholder="Chapter">

<select id="rVersion" class="form-select mb-2">
<option value="kjv">KJV</option>
<option value="web">WEB</option>
</select>

<div class="d-grid gap-2">
<button class="btn btn-primary" onclick="readChapter()">Load Chapter</button>
<button class="btn btn-success" onclick="readText('chapterText')">üîä Read Aloud</button>
<button class="btn btn-outline-dark" onclick="downloadChapter()">üì• Save Offline</button>
</div>

<div id="chapterText" class="mt-3"></div>
</div>

</div>

<footer class="text-center p-3 bg-dark text-light">
<div style="color: gold; font-size: 1.5em; font-style: italic;">Evangelist Engr. Stephen Jolayemi &nbsp;¬© 2026 All rights reserved</div>
</footer>

<script>
/* =======================
   USER PREFERENCES
======================= */
let fontSize = Number(localStorage.getItem("fontSize")) || 18;
document.body.style.fontSize = fontSize+"px";

if(localStorage.getItem("dark")==="true") document.body.classList.add("dark");
if(localStorage.getItem("contrast")==="true") document.body.classList.add("high-contrast");

/* =======================
   VOICES + ANDROID FALLBACK
======================= */
let voices = [];
function loadVoices(){
  voices = speechSynthesis.getVoices();
  voiceSelect.innerHTML = voices.map((v,i)=>
    `<option value="${i}">${v.name}</option>`).join("");

  voiceSelect.value = localStorage.getItem("voice") || 0;
}
speechSynthesis.onvoiceschanged = loadVoices;

/* =======================
   TTS CONTROLS
======================= */
let utterance;

function readText(id){
  const text = document.getElementById(id)?.innerText;
  if(!text) return;

  localStorage.setItem("lastText", text);

  // ANDROID NATIVE FALLBACK
  if(window.Android){
    Android.readText(text);
    return;
  }

  speechSynthesis.cancel();
  utterance = new SpeechSynthesisUtterance(text);
  utterance.voice = voices[voiceSelect.value] || null;
  utterance.rate = 0.9;

  localStorage.setItem("voice", voiceSelect.value);
  setTimeout(()=>speechSynthesis.speak(utterance),100);
}

function pauseSpeech(){ speechSynthesis.pause(); }
function resumeSpeech(){ speechSynthesis.resume(); }
function stopSpeech(){ speechSynthesis.cancel(); }

/* =======================
   UI CONTROLS
======================= */
function changeFont(d){
  fontSize = Math.max(14, Math.min(30, fontSize+d));
  document.body.style.fontSize = fontSize+"px";
  localStorage.setItem("fontSize",fontSize);
}
function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("dark",document.body.classList.contains("dark"));
}
function toggleContrast(){
  document.body.classList.toggle("high-contrast");
  localStorage.setItem("contrast",document.body.classList.contains("high-contrast"));
}

/* =======================
   DAILY VERSE + AUTO READ
======================= */
async function loadVerse(){
  try{
    const r = await fetch("https://bible-api.com/Psalm+23:1");
    const d = await r.json();
    scripture.innerHTML = `"${d.text}"<br><b>${d.reference}</b>`;
    localStorage.setItem("dailyVerse", scripture.innerText);
    setTimeout(()=>readText("scripture"),500);
  }catch{
    scripture.innerText = localStorage.getItem("dailyVerse") || "Offline";
  }
}
loadVerse();

/* =======================
   CHAPTER + OFFLINE PACKS
======================= */
function toggleReader(){
  reader.style.display = reader.style.display==="none"?"block":"none";
}

async function readChapter(){
  try{
    const r = await fetch(`https://bible-api.com/${rBook.value}+${rChapter.value}`);
    const d = await r.json();
    const text = d.verses.map(v=>`${v.verse}. ${v.text}`).join(" ");
    chapterText.innerText = text;
    localStorage.setItem("lastChapter", text);
  }catch{
    chapterText.innerText = localStorage.getItem("lastChapter") || "Offline";
  }
}

function downloadChapter(){
  if(chapterText.innerText){
    localStorage.setItem(
      `${rBook.value}_${rChapter.value}`,
      chapterText.innerText
    );
    alert("Chapter saved for offline use.");
  }
}
</script>

</body>
</html>
